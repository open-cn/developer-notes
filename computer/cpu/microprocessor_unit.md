### 微处理器

Microprocessor Unit，MPU

### 概述

微处理器由一片或少数几片大规模集成电路组成的中央处理器。这些电路执行控制部件和算术逻辑部件的功能。

微处理器能完成取指令、执行指令，以及与外界存储器和逻辑部件交换信息等操作，是微型计算机的运算控制部分。它可与存储器和外围电路芯片组成微型计算机。

微处理器与传统的中央处理器相比，具有体积小、重量轻和容易模块化等优点。微处理器的基本组成部分有：寄存器堆、运算器、时序控制电路，以及数据和地址总线。

自从人类1947年发明晶体管以来，半导体技术经历了硅晶体管、集成电路、超大规模集成电路、甚大规模集成电路等几代。

中央处理器是指计算机内部对数据进行处理并对处理过程进行控制的部件，伴随着大规模集成电路技术的迅速发展，芯片集成密度越来越高，CPU可以集成在一个半导体芯片上，这种具有中央处理器功能的大规模集成电路器件，被统称为“微处理器”。需要注意的是：微处理器本身并不等于微型计算机，仅仅是微型计算机的中央处理器。


1. 第一阶段

（1971—1973年）通常以字长是4位或8位微处理器，典型的是美国 Intel 4004和Intel 8008微处理器。

Intel 4004是一种4位微处理器，可进行4位二进制的并行运算，它有45条指令，速度0.05MIPs（Million Instruction Per Second，每秒百万条指令）。Intel 4004的功能有限，主要用于计算器、电动打字机、照相机、台秤、电视机等家用电器上，使这些电器设备具有智能化，从而提高它们的性能。

Intel 8008是世界上第一种8位的微处理器。存储器采用PMOS工艺。该阶段计算机工作速度较慢，微处理器的指令系统不完整，存储器容量很小，只有几百字节，没有操作系统，只有汇编语言。主要用于工业仪表、过程控制。


2. 第二阶段

（1974—1977年）典型的微处理器有Intel 8080/8085，Zilog公司的Z80和Motorola公司的M6800。

与第一代微处理器相比，集成度提高了1～4倍，运算速度提高了10～15倍，指令系统相对比较完善，已具备典型的计算机体系结构及中断、直接存储器存取等功能。

但这些芯片基本没有改变8080的基本特点，都属于第二代微处理器。它们均采用NMOS工艺,集成度约9000只晶体管,平均指令执行时间为1μS～2μS,采用汇编语言、BASIC、Fortran编程，使用单用户操作系统。


3. 第三阶段

（1978—1984年）即16位微处理器。1978 年，Intel公司率先推出16位微处理器8086，同时，为了方便原来的8位机用户，Intel公司又提出了一种准16位微处理器8088。

英特尔在后续CPU的命名上沿用了原先的x86序列，直到后来因商标注册问题，才放弃了继续用阿拉伯数字命名。
在Intel公司推出8086、8088 CPU之后，各公司也相继推出了同类的产品，有Zilog公司Z8000和Motorola公司的M68000等。
1981年，美国IBM公司将8088芯片用于其研制的IBM-PC机中，从而开创了全新的微机时代。
80286的封装是一种被称为PGA的正方形包装。PGA是源于PLCC的便宜封装，它有一块内部和外部固体插脚，在这个封装中，80286集成了大约130000个晶体管。


4. 第四阶段

（1985—1992年）即32位微处理器。1985年10月17日，英特尔划时代的产品——80386DX正式发布了，其内部包含27.5万个晶体管，时钟频率为12.5MHz，后逐步提高到20MHz、25MHz、33MHz，最后还有少量的40MHz产品。

80486 在80x86系列中首次采用了RISC技术，可以在一个时钟周期内执行一条指令。


5. 第五阶段

（1993-2005年）是奔腾（pentium）系列微处理器时代，通常称为第5代。典型产品是Intel公司的奔腾系列芯片及与之兼容的AMD的K6系列微处理器芯片。

内部采用了超标量指令流水线结构，并具有相互独立的指令和数据高速缓存。
为了提高电脑在多媒体、3D图形方面的应用能力，许多新指令集应运而生，其中最著名的三种便是英特尔的MMX、SSE和AMD的3D NOW!。 微机的发展在网络化、多媒体化和智能化等方面跨上了更高的台阶。

2002年英特尔推出新款Intel Pentium 4处理器内含创新的Hyper-Threading(HT）超线程技术。
一系列与减少功耗有关的设计：增强型Speedstep技术是必不可少的了，拥有多个供电电压和计算频率。

与以前的Socket 478接口CPU不同，LGA 775接口CPU的底部没有传统的针脚，而代之以775个触点，即并非针脚式而是触点式，通过与对应的LGA 775插槽内的775根触针接触来传输信号。LGA 775接口不仅能够有效提升处理器的信号强度、提升处理器频率，同时也可以提高处理器生产的良品率、降低生产成本。


6. 第六阶段

（2005年至今）是酷睿（core）系列微处理器时代，通常称为第6代。

“酷睿”是一款领先节能的新型微架构，设计的出发点是提供卓然出众的性能和能效，提高每瓦特性能，也就是所谓的能效比。早期的酷睿是基于笔记本处理器的。 

酷睿2：英文名称为Core 2 Duo，是英特尔在2006年推出的新一代基于Core微架构的产品体系统称。于2006年7月27日发布。酷睿2是一个跨平台的构架体系，包括服务器版、桌面版、移动版三大领域。其中，服务器版的开发代号为Woodcrest，桌面版的开发代号为Conroe，移动版的开发代号为Merom。

继LGA775接口之后，Intel首先推出了LGA1366平台，定位高端旗舰系列。

LGA1366平台再次引入了Intel超线程技术，同时QPI总线技术取代了由Pentium 4时代沿用至今的前端总线设计。最重要的是LGA1366平台是支持三通道内存设计的平台，在实际的效能方面有了更大的提升。

AMD的第一款原生四核处理器是于2007年11月20日发布的基于AMD K10架构的桌面Phenom处理器（中文名为弈龙）

Intel的第一款原生四核处理器是于2008年推出的64位四内核CPU——Core i7（中文：酷睿i7，内核代号：Bloomfield），沿用I7 920x86-64指令集，并以Intel Nehalem微架构为基础，取代Intel Core 2系列处理器。

Intel Core i7是一款45nm原生四核处理器，处理器拥有8MB三级缓存，支持三通道DDR3内存。处理器采用LGA 1366针脚设计，支持第二代超线程技术，也就是处理器能以八线程运行。根据网上流传的测试，同频Core i7比Core 2 Quad性能要高出很多。

Core i5是一款基于Nehalem架构的四核处理器，采用整合内存控制器，三级缓存模式，L3达到8MB，支持Turbo Boost等技术的新处理器电脑配置。它和Core i7（Bloomfield）的主要区别在于总线不采用QPI，采用的是成熟的DMI（Direct Media Interface），并且只支持双通道的DDR3内存。结构上它用的是LGA1156 接口，Core i7用的是LGA1366。i5有睿频技术，可以在一定情况下超频。

Core i3可看作是Core i5的进一步精简版（或阉割版），将有32nm工艺版本（研发代号为Clarkdale，基于Westmere架构）这种版本。Core i3最大的特点是整合GPU（图形处理器），也就是说Core i3将由CPU+GPU两个核心封装而成。由于整合的GPU性能有限，用户想获得更好的3D性能，可以外加显卡。值得注意的是，即使是Clarkdale，显示核心部分的制作工艺仍会是45nm。i3 i5 区别最大之处是 i3没有睿频技术。

2010年6月，Intel再次发布革命性的处理器——第二代Core i3/i5/i7。第二代Core i3/i5/i7隶属于第二代智能酷睿家族，全部基于全新的Sandy Bridge微架构，相比第一代产品主要带来五点重要革新：1、采用全新32nm的Sandy Bridge微架构，更低功耗、更强性能。2、内置高性能GPU（核芯显卡），视频编码、图形性能更强。 3、睿频加速技术2.0，更智能、更高效能。4、引入全新环形架构，带来更高带宽与更低延迟。5、全新的AVX、AES指令集，加强浮点运算与加密解密运算。

SNB(Sandy Bridge）是英特尔在2011年初发布的新一代处理器微架构，这一构架的最大意义莫过于重新定义了“整合平台”的概念，与处理器“无缝融合”的“核芯显卡”终结了“集成显卡”的时代。


### 微处理器的分类

根据微处理器的应用领域，微处理器大致可以分为三类：通用高性能微处理器、嵌入式微处理器和数字信号处理器、微控制器。

一般而言，通用处理器追求高性能，它们用于运行通用软件，配备完备、复杂的操作系统；

嵌入式微处理器强调处理特定应用问题的高性能，主要用于运行面向特定领域的专用程序，配备轻量级操作系统，主要用于蜂窝电话、CD播放机等消费类家电；

微控制器价位相对较低，在微处理器市场上需求量最大，主要用于汽车、空调、自动机械等领域的自控设备。

### 体系结构


#### 复杂指令集计算机

Complex Instruction Set Computer，CISC

设计策略是使用大量的指令，包括复杂指令。指令集的复杂性使得CPU和控制单元的电路非常复杂。

CISC架构的服务器主要以IA-32架构（IntelArchitecture，英特尔架构）为主，而且多数为中低档服务器所采用。

#### 精简指令集计算机

Reduced Instruction Set Computer，RISC

在CISC指令集的各种指令中，其使用频率却相差悬殊，大约有20%的指令会被反复使用，占整个程序代码的80%。而余下的80%的指令却不经常使用，在程序设计中只占20%。基于RISC的系统通常比CISC系统速度快。它的80/20规则促进了RISC体系结构的发展。通过简化计算机指令功能，使指令的平均执行周期减少，从而提高计算机的工作主频，同时大量使用通用寄存器来提高子程序执行的速度。

和英特尔采用的复杂指令系统计算结构（CISC）相比，RISC具有设计更简单、设计周期更短等优点，并可以应用更多先进的技术，开发更快的下一代处理器。

起源于80年代的MIPS主机（即RISC机），RISC机中采用的微处理器统称RISC处理器。

##### 无内部互锁流水级的微处理器

Microprocessor without interlocked piped stages，MIPS

MIPS的系统结构及设计理念比较先进，其指令系统经过通用处理器指令体系MIPS I、MIPS II、MIPS III、MIPS IV到MIPS V，嵌入式指令体系MIPS16、MIPS32到MIPS64的发展已经十分成熟。在设计理念上MIPS强调软硬件协同提高性能，同时简化硬件设计。

MIPS在RISC处理器方面占有重要地位。1984年，MIPS计算机公司成立。1992年，SGI收购了MIPS计算机公司。1998年，MIPS脱离SGI，成为MIPS技术公司。随着移动互联网的兴起，MIPS 指令集逐渐衰落，公司也多次辗转被收购。


##### ARM 处理器

Advanced RISC Machine

英国Acorn有限公司设计的低功耗成本的第一款RISC微处理器。ARM处理器的三大特点是：耗电少功能强、16位/32位双指令集和合作伙伴众多。

ARM公司既不生产芯片也不销售芯片，它只出售芯片技术授权。

支持两种指令集：ARM指令集和Thumb指令集。其中，ARM指令为32位的长度，Thumb指令为16位长度。Thumb指令集为ARM指令集的功能子集，但与等价的ARM代码相比较，可节省30%～40%以上的存储空间。

ARM在看到移动设备对64位计算的需求后，于2011年发布了ARMv8 64位架构。为了基于原有的原则和指令集，开发一个简明的64位架构，ARMv8使用了两种执行模式，AArch32和AArch64。

ARM的big.LITTLE架构是一项Intel一时无法复制的创新。在big.LITTLE架构里，处理器可以是不同类型的。传统的双核或者四核处理器中包含同样的2个核或者4个核。一个双核Atom处理器中有两个一模一样的核，提供一样的性能，拥有相同的功耗。ARM通过big.LITTLE向移动设备推出了异构计算。这意味着处理器中的核可以有不同的性能和功耗。当设备正常运行时，使用低功耗核，而当你运行一款复杂的游戏时，使用的是高性能的核。

ARM处理器共有37个寄存器，被分为若干个组（BANK），这些寄存器包括：
1.　31个通用寄存器，包括程序计数器（PC指针），均为32位的寄存器。
2.　6个状态寄存器，用以标识CPU的工作状态及程序的运行状态，均为32位，只使用了其中的一部分。


家族  	架构 		内核
ARM1 	ARMv1 	ARM1
ARM2 	ARMv2 	ARM2
           	ARMv2a 	ARM250
ARM3 	ARMv2a 	ARMv2a

ARM6 	ARMv3 	ARM610

ARM7TDMI 	ARMv4T 	ARM7TDMI(-S)
                                       	ARM710T
                                       	ARM720T
                                       	ARM740T

                      ARMv5TEJ 	ARM7EJ-S
ARM9TDMI 	ARMv4T 	ARM9TDMI
                                       	ARM920T
                                       	ARM922T
                                       	ARM940T

ARM9E 	ARMv5TE 	ARM946E-S
                                       	ARM966E-S
                                       	ARM968E-S
                     ARMv5TEJ 	ARM926EJ-S
                        ARMv5TE 	ARM996HS

ARM10E 	ARMv5TE 	ARM1020E
                                       	ARM1022E
                                       	ARM1026EJ-S

XScale 	ARMv5TE 	太多了



ARM11 	ARMv6     	ARM1136J(F)-S
         	ARMv6T2		ARM1156T2(F)-S
         	ARMv6KZ 	ARM1176JZ(F)-S
         	ARMv6K   	ARM11 MPCore

Cortex 	ARMv6-M 	Cortex-M0 	Cortex-M0+ 	Cortex-M1
         	ARMv7-M 	Cortex-M3
         	ARMv7E-M 	Cortex-M4 	Cortex-M7
         	ARMv7-R 	Cortex-R4 	Cortex-R5 	Cortex-R7 	Cortex-R8
         	ARMv7-A 	Cortex-A5 	Cortex-A7 	Cortex-A8 	Cortex-A9 	Cortex-A12 	Cortex-A15 	Cortex-A17
         	ARMv8-M 	Cortex-M23 	Cortex-M33
                 ARMv8-R 	Cortex-R52
         	ARMv8-A 	Cortex-M35 	Cortex-A53 	Cortex-A57 	Cortex-A72 	Cortex-A73
         	                 	64 	Cortex-A34
         	ARMv8.2-A  	Cortex-A55 	Cortex-A75 	Cortex-A76 	Cortex-A77 	Cortex-A78 	Cortex-AX1
         	                 	64 	Cortex-A65 	Cortex-A65AE

Neoverse 	ARMv8.2-A 	N1
                 	                    	64 	E1

ARM7系列　ARM9系列　ARM9E系列　ARM10E系列


SecurCore系列　Intel的StrongARM ARM11系列 Intel的Xscale





#### 发展前景

目前大多数RISC处理器已达到了每个周期执行一条指令的目标（即CPI比率），但这并不是极限，RISC技术中又出现了超级标量和超级流水线技术。

超级标量技术就是使微处理器在一个时钟周期内并行地执行几条指令，而超级流水线技术则是主流水线段(指令译码和指令执行)只占一个时钟周期的一部分，这样，仍可在一个时钟周期内同时执行几条指令。

Intel 8096 就采用了超级标量技术，它能同时执行整数指令和浮点指令.IBM公司的RS/6000也采用的是超级标量结构，处理器包含三个不同的处理部件:定点处理器、浮点处理器、分支处理器，一个时钟周期可执行四条指令（4IPC），最多可达6IPc。

RISC科学家指出，过去那种令人鼓舞的微处理器性能提高过程不大可能继续下去，今后，Cache的容量及其结构和优化编译器将成为提高计算机性能的关键因素。


美国国家半导休公司的NSC32532微处理器在CISC设计中采用了RISC技术，使指令平均执行时间从原来的6个机器周期降到小于2.4个机器周期，在26MHZ主频下，运行速度达10一12M1PS。Intel 80486和Motorola 68040也吸收了RISC设计技术，从而达到每条指令平均执行时间小于2个机器周期。仙童公司的Clipper机是综合R1SC与CISC技术优点的32位微处理机，其运行速度高达33MIPS。

目前已有人将CISC技术和RISC技术溶合在一起，提出了可写指令集计算机（WISC）结构设想，并具体规定了集中Rlsc和Clsc优点的策略原则，尽管如此，它仍是建立在RlSC概念笋碑上的一个RISC技犬的进一步发屏。

现代的CPU往往采用CISC的外围，内部加入了RISC的特性，如超长指令集CPU就是融合了RISC和CISC的优势，成为未来的CPU发展方向之一。



