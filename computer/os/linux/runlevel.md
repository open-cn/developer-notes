## Linux系统中的运行级别

运行级别（Runlevel）指的是Unix或者Linux等类Unix操作系统的运行模式，不同的运行模式下系统的功能也有所有不同。


#### 7种运行级别

Linux 系统下通常分为7种运行级别，分别是从0到6。各级别介绍如下：

- 0 - 停机模式。在这种模式下，系统处于停机状态，系统默认运行级别不能设为0，否则将不能正常启动，这个运行级别主要用于关闭任务，在/etc/rc0.d目录下的各个连接命令都是此级别的命令，在关闭系统时，这些命令将被逐个执行。它们会杀掉所有进程、关闭虚拟内存和交换文件、卸载文件系统和交换分区。
- 1 - 单用户模式。在这种运行模下，系统处于单用户工作状态，登录用户具有root权限，文件系统被加载但是网络却没有被加载，因此也无法远程登陆。这个运行级别，只允一个用户从本地计算机上登录，/etc/rc1.d目录下的所有文件与此运行级别相关连，这个运行级别一般用于系统管理与维护。
- 2 - 多用户模式。用户可以通过网络进行登录，但没有NFS（Network File System），即网络文件系统。/etc/rc2.d目录下所有文件与此级别相连。
- 3 - 完全多用户模式。用户可以通过网络进行登录，且有NFS，用户登陆后会进入控制台命令行模式。这也是缺省的运行模式，在这种运行级别下所有网络服务程序会一起运行。/etc/rc2.d录下的文件与此级别相连
- 4 - 自定义模式。这是一种系统未使用的保留模式，/etc/rc4.d目录与此级别相连。这一级别是用户自定义的运行级别，用户可以根自己的需要进行一些自定义设置。如果想要运行这一级别的话，必须在rc3.d目录下放入连接文件，就像其他rc*.d目录下的文件，并指明是启动还是终止进程。
- 5 - 图形化模式。在 Linux 下运行X Window就是使用这一运行级别，用户登录后将进入图形化的GUI界面。在这一级别下除了DNS的named与级别3不同，其余的都相同。
- 6 - 重启模式。系统正常关闭并重启，默认运行级别不能设为5，否则系统将不能正常启动。/etc/rc6.d目录与此级别相连。在这一运行级别下，不会关闭电源，/etc/rc6.d目录下的连接与rc0.d目录下的连接基本相同；不同之处在于，虽然它们都执行halt（关闭）命令，但是给halt传递的参数不同，所级别6会重新启动系统而0会关闭系统。

注意：以上适用于CentOS等发行版，而对于Ubuntu等debian系的Linux来说，2\~5都是多用户图形模式，几个运行模式没有区别。



#### 不同运行级别的实现原理

如上所述，Linux系统的每一个运行级别，都对应一个目录。

在/etc/init.d目录下有许多脚本程序，我们将这些程序称之为服务(Service)。

而/etc目录下，还有rc0.d\~rc6.d共7个目录。在这些目录下都是一些软链接文件，这些链接文件都指向了init.d目录下的service脚本文件。而这些软连接的命名规则为：K+nn+服务名或S+nn+服务名，其中nn为两位数字。

系统启动时，会根据当前运行级别进入对应的rc\*.d目录，然后按照文件名顺序检索目录下的链接文件，并会做以下处理：

- 对于以K开头的文件，系统将终止对应的服务
- 对于以S开头的文件，系统将启动对应的服务

注意：/etc/init.d存在于Ubuntu等发行版中，而CentOS等发行版中位于/etc/rc.d/init.d目录下，但通过/etc/init.d软连接进行关联。同样的，rc\*.d等目录，在Ubuntu等系统中位于/etc/目录下，而在CentOS等系统中位于/etc/rc.d目录下，但在/etc下都有对应的软连接。






















